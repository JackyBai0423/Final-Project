---
title: "SquirrelDistribution"
author: "Peiyuan Li, Xuyang Liu, Yuwei Tang, Jacky Bai"
date: "2022-08-04"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(lubridate)
# source("ggprob.R")

```

Project Title: Squirrel Distribution

Background: 
The dataset collected by the Squirrel Census contains squirrels data for each of the 3023 sightings in the New York Central Park in 2018, and demonstrates its findings to the public in 2019. This dataset provides us with location coordinates, primary and secondary fur colors, sighting time and other important data.


Introduction: 
Squirrels at New York City central park are becoming a popular scene among citizens and travelers. Our project will present a solid analysis of squirrel data collected at NYC central park and provide distribution data and graphs of squirrels of different fur colors.

## Read CSV data

```{r read_data, include=FALSE}
data_org = read_csv("./2018_Central_Park_Squirrel_Census_-_Squirrel_Data.csv")

data = data_org %>% select(X, Y,Hectare, `Hectare Squirrel Number`, `Unique Squirrel ID`, Shift,Age,`Primary Fur Color`,Location)

data = data %>% rename(x= X, y = Y, hectare = Hectare, hectare_num = `Hectare Squirrel Number`, id = `Unique Squirrel ID`, time = Shift, age = Age, fur_color = `Primary Fur Color`, location = Location) %>% 
  mutate(fur_color=tolower(fur_color)) %>%
  drop_na()%>%
  mutate(vertical=ceiling(as.numeric(str_sub(hectare,1,2))/3),horizontal=str_sub(hectare,3,3))
```

```{r}
am_squirrel = data %>%
  filter(time == "AM") %>%
  group_by(horizontal, vertical, fur_color) %>%
  summarise(number = sum(hectare_num))
pm_squirrel = data %>%
  filter(time == "PM") %>%
  group_by(horizontal, vertical, fur_color) %>%
  summarise(number = sum(hectare_num))
ggplot(data = am_squirrel, aes(x=horizontal,y=vertical))+
  geom_point(aes(color=fur_color,size = number))+
  facet_wrap(~fur_color)
ggplot(data = pm_squirrel, aes(x=horizontal,y=vertical))+
  geom_point(aes(color=fur_color))+
  facet_wrap(~fur_color)
by_hectare = data %>% group_by(hectare,fur_color)

```







